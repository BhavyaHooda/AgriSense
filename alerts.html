
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
    <title>AgriSense Pro - Alert Command Center</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <link rel="stylesheet" href="styles.css">
<style>
    /* Additional alert page specific styles */
    .alert-dashboard {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 20px;
        margin: 20px auto;
        width: 100%;
        max-width: 1200px;
        justify-content: center;
    }
    
    .alert-stat-card {
        text-align: center;
        padding: 20px;
        border-radius: 12px;
        background: white;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }
    
    .alert-stat-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 25px rgba(0,0,0,0.15);
    }
    
    .alert-category {
        font-size: 16px;
        font-weight: 600;
        margin-bottom: 10px;
        color: var(--dark-color);
        text-align: center;
    }
    
    .alert-count {
        font-size: 32px;
        font-weight: 700;
        color: var(--primary-color);
        text-align: center;
        margin: 10px 0;
    }
    
    .alert-chart {
        min-height: 350px !important;
        height: 350px !important;
        margin: 25px auto;
        width: 100%;
        max-width: 1200px;
    }
    
    @media (max-width: 767px) {
        .alert-chart {
            min-height: 250px !important;
            height: 250px !important;
        }
    }
    
    .alert-item {
        display: flex;
        align-items: center;
        gap: 16px;
        padding: 18px;
        border-radius: 12px;
        background: #fff;
        margin-bottom: 18px;
        border: 1px solid var(--border-color);
        transition: all 0.3s ease;
        box-shadow: var(--shadow-light);
        width: 100%;
        max-width: 1200px;
        box-sizing: border-box;
        margin-left: auto;
        margin-right: auto;
    }
    
    .alert-item:hover {
        transform: translateX(10px);
        box-shadow: var(--shadow-dark);
    }
    
    .alert-icon {
        width: 65px;
        height: 65px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 26px;
        transition: transform 0.4s;
        flex-shrink: 0;
    }
    
    .alert-item:hover .alert-icon {
        transform: scale(1.15);
    }
    
    .alert-content {
        flex: 1;
        display: flex;
        flex-direction: column;
    }
    
    .alert-title {
        font-weight: 700;
        font-size: 18px;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        flex-wrap: wrap;
    }
    
    .alert-message {
        font-size: 15px;
        color: var(--text-secondary);
        margin-bottom: 10px;
        line-height: 1.5;
    }
    
    .alert-time {
        font-size: 13px;
        color: #999;
        font-style: italic;
    }
    
    .alert-actions {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 12px;
        justify-content: flex-start;
    }
    
    .alert-filter {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        margin-bottom: 25px;
        justify-content: center;
        width: 100%;
        max-width: 1200px;
        margin-left: auto;
        margin-right: auto;
    }
    
    .filter-button {
        padding: 10px 18px;
        border-radius: 24px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        background: white;
        border: 1px solid var(--border-color);
        text-align: center;
    }
    
    .filter-button:hover, .filter-button.active {
        background: var(--primary-color);
        color: white;
        border-color: var(--primary-color);
    }
    
    .alert-badge {
        font-size: 12px;
        padding: 4px 12px;
        border-radius: 20px;
        font-weight: 600;
        color: white;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        margin-right: 12px;
    }
    
    .alert-badge.high {
        background: var(--error-color);
    }
    
    .alert-badge.medium {
        background: var(--warning-color);
    }
    
    .alert-badge.low {
        background: var(--info-color);
    }
    
    .alert-settings {
        padding: 25px;
        background: white;
        border-radius: 16px;
        margin: 35px auto;
        box-shadow: var(--shadow-light);
        max-width: 1200px;
        width: 100%;
    }
    
    .settings-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px 0;
        border-bottom: 1px solid var(--border-color);
    }
    
    .settings-row:last-child {
        border-bottom: none;
    }
    
    .alert-type {
        display: flex;
        align-items: center;
        gap: 12px;
        font-weight: 600;
    }
    
    .alert-threshold {
        display: flex;
        align-items: center;
        gap: 18px;
        flex-wrap: wrap;
    }
    
    .threshold-control {
        width: 80px;
        padding: 8px;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        text-align: center;
    }
    
    /* Alert type-specific colors */
    .alert-item.temperature {
        border-left: 5px solid #f44336;
    }
    
    .alert-item.humidity {
        border-left: 5px solid #2196f3;
    }
    
    .alert-item.battery {
        border-left: 5px solid #ffc107;
    }
    
    .alert-item.system {
        border-left: 5px solid #9c27b0;
    }
    
    .alert-item.connectivity {
        border-left: 5px solid #ff5722;
    }
    
    .alert-item.crop {
        border-left: 5px solid #4caf50;
    }
    
    .alert-icon.temperature {
        background: rgba(244, 67, 54, 0.1);
        color: #f44336;
    }
    
    .alert-icon.humidity {
        background: rgba(33, 150, 243, 0.1);
        color: #2196f3;
    }
    
    .alert-icon.battery {
        background: rgba(255, 193, 7, 0.1);
        color: #ffc107;
    }
    
    .alert-icon.system {
        background: rgba(156, 39, 176, 0.1);
        color: #9c27b0;
    }
    
    .alert-icon.connectivity {
        background: rgba(255, 87, 34, 0.1);
        color: #ff5722;
    }
    
    .alert-icon.crop {
        background: rgba(76, 175, 80, 0.1);
        color: #4caf50;
    }
    
    /* Timeline visualization */
    .alert-timeline {
        position: relative;
        margin: 35px auto;
        padding-left: 30px;
        max-width: 1200px;
        width: 100%;
    }
    
    .timeline-line {
        position: absolute;
        left: 15px;
        top: 0;
        bottom: 0;
        width: 2px;
        background: var(--border-color);
    }
    
    .timeline-dot {
        position: absolute;
        left: 9px;
        width: 14px;
        height: 14px;
        border-radius: 50%;
        background: var(--primary-color);
        border: 2px solid white;
    }
    
    .timeline-item {
        position: relative;
        margin-bottom: 35px;
        padding-bottom: 18px;
        border-bottom: 1px dashed var(--border-color);
    }
    
    .timeline-item:last-child {
        border-bottom: none;
    }
    
    .timeline-alert {
        padding: 18px;
        background: white;
        border-radius: 12px;
        box-shadow: var(--shadow-light);
    }
    
    /* Section alignment improvements */
    .section {
        text-align: center;
        margin-left: auto;
        margin-right: auto;
        max-width: 1200px;
        width: 100%;
    }
    
    .section-header {
        text-align: center;
        margin-bottom: 20px;
    }
    
    .section-title {
        text-align: center;
        margin: 0 auto 15px;
        display: inline-flex;
        justify-content: center;
    }
    
    .action-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        justify-content: center;
        margin: 10px auto;
    }
    
    /* Make buttons more consistent */
    .btn {
        padding: 8px 12px;
        border-radius: 6px;
        font-size: 12px;
        text-align: center;
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }
    
    /* Responsive improvements */
    @media (max-width: 768px) {
        .alert-settings {
            padding: 15px;
        }
        
        .settings-row {
            flex-direction: column;
            align-items: flex-start;
            gap: 10px;
        }
        
        .alert-threshold {
            width: 100%;
            justify-content: space-between;
        }
        
        .alert-item {
            flex-direction: column;
            align-items: flex-start;
        }
        
        .alert-icon {
            margin-bottom: 10px;
        }
        
        .alert-actions {
            justify-content: center;
            width: 100%;
        }
    }
</style>
</head>
<body>
    <div class="phone-frame" style="max-width: 100%; height: 100%;">
        <div class="header">
            <div class="header-title">
                <i class="fas fa-bell"></i>
                Alert Command Center
            </div>
            <div class="header-actions">
                <a href="index.html" class="header-icon" title="Back to Dashboard"><i class="fas fa-home"></i></a>
                <span class="header-icon" onclick="clearAllAlerts()" title="Clear All Alerts"><i class="fas fa-trash-alt"></i></span>
                <span class="header-icon" onclick="configureAlertSettings()" title="Alert Settings"><i class="fas fa-cog"></i></span>
            </div>
        </div>

        <div class="content" style="max-width: 100%;">
            <!-- Alert Overview Section -->
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-tachometer-alt"></i>
                        Alert Overview
                    </h2>
                    <div class="action-buttons">
                        <span class="btn" onclick="refreshAlerts()" title="Refresh Alert Data"><i class="fas fa-sync-alt"></i> Refresh</span>
                        <span class="btn" onclick="testAlert()" title="Test Alert System"><i class="fas fa-check-circle"></i> Test Alert</span>
                        <span class="btn" onclick="exportAlertData()" title="Export Alert History"><i class="fas fa-download"></i> Export</span>
                        <span class="btn" onclick="setAlertRules()" title="Configure Alert Rules"><i class="fas fa-sliders-h"></i> Set Rules</span>
                    </div>
                </div>
                
                <div class="alert-dashboard">
                    <div class="alert-stat-card" onclick="filterAlerts('temperature')">
                        <div class="alert-category">Temperature</div>
                        <div class="alert-count" id="temperatureAlertCount">2</div>
                        <div class="progress-bar"><div class="progress-fill" style="width: 20%;" id="temperatureProgress"></div></div>
                    </div>
                    <div class="alert-stat-card" onclick="filterAlerts('humidity')">
                        <div class="alert-category">Humidity</div>
                        <div class="alert-count" id="humidityAlertCount">1</div>
                        <div class="progress-bar"><div class="progress-fill" style="width: 10%;" id="humidityProgress"></div></div>
                    </div>
                    <div class="alert-stat-card" onclick="filterAlerts('battery')">
                        <div class="alert-category">Battery</div>
                        <div class="alert-count" id="batteryAlertCount">3</div>
                        <div class="progress-bar"><div class="progress-fill" style="width: 30%;" id="batteryProgress"></div></div>
                    </div>
                    <div class="alert-stat-card" onclick="filterAlerts('system')">
                        <div class="alert-category">System</div>
                        <div class="alert-count" id="systemAlertCount">0</div>
                        <div class="progress-bar"><div class="progress-fill" style="width: 0%;" id="systemProgress"></div></div>
                    </div>
                    <div class="alert-stat-card" onclick="filterAlerts('connectivity')">
                        <div class="alert-category">Connectivity</div>
                        <div class="alert-count" id="connectivityAlertCount">1</div>
                        <div class="progress-bar"><div class="progress-fill" style="width: 10%;" id="connectivityProgress"></div></div>
                    </div>
                    <div class="alert-stat-card" onclick="filterAlerts('crop')">
                        <div class="alert-category">Crop Health</div>
                        <div class="alert-count" id="cropAlertCount">2</div>
                        <div class="progress-bar"><div class="progress-fill" style="width: 20%;" id="cropProgress"></div></div>
                    </div>
                </div>
                
                <div class="chart-container alert-chart">
                    <canvas id="alertsOverviewChart"></canvas>
                </div>
            </div>
            
            <!-- Alert List Section -->
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-bell"></i>
                        Active Alerts
                    </h2>
                    <div class="action-buttons">
                        <span class="btn" onclick="markAllAsRead()" title="Mark All as Read"><i class="fas fa-check"></i> Mark All Read</span>
                        <span class="btn" onclick="archiveAlerts()" title="Archive Resolved Alerts"><i class="fas fa-archive"></i> Archive</span>
                        <span class="btn" onclick="sortAlerts('time')" title="Sort by Time"><i class="fas fa-clock"></i> Sort by Time</span>
                        <span class="btn" onclick="sortAlerts('priority')" title="Sort by Priority"><i class="fas fa-exclamation-triangle"></i> Sort by Priority</span>
                    </div>
                </div>
                
                <div class="alert-filter">
                    <span class="filter-button active" onclick="filterAlerts('all')">All</span>
                    <span class="filter-button" onclick="filterAlerts('high')">High Priority</span>
                    <span class="filter-button" onclick="filterAlerts('medium')">Medium Priority</span>
                    <span class="filter-button" onclick="filterAlerts('low')">Low Priority</span>
                    <span class="filter-button" onclick="filterAlerts('unread')">Unread</span>
                </div>
                
                <div class="alert-list" id="alertList">
                    <!-- Temperature Alert -->
                    <div class="alert-item temperature" data-priority="high" data-read="false">
                        <div class="alert-icon temperature">
                            <i class="fas fa-thermometer-full"></i>
                        </div>
                        <div class="alert-content">
                            <div class="alert-title">
                                <span class="alert-badge high">High</span>
                                High Temperature Detected
                            </div>
                            <div class="alert-message">Sensor 1 temperature exceeds threshold (85째F) in Corn Field A, Row 1.</div>
                            <div class="alert-time">5 minutes ago</div>
                            <div class="alert-actions">
                                <button class="btn" onclick="markAsRead(this)">Mark as Read</button>
                                <button class="btn" onclick="viewSensorDetail('Sensor 1')">View Sensor</button>
                                <button class="btn danger" onclick="dismissAlert(this)">Dismiss</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Battery Alert -->
                    <div class="alert-item battery" data-priority="medium" data-read="false">
                        <div class="alert-icon battery">
                            <i class="fas fa-battery-quarter"></i>
                        </div>
                        <div class="alert-content">
                            <div class="alert-title">
                                <span class="alert-badge medium">Medium</span>
                                Low Battery Warning
                            </div>
                            <div class="alert-message">Sensor 2 battery level is at 20%, replacement needed soon.</div>
                            <div class="alert-time">15 minutes ago</div>
                            <div class="alert-actions">
                                <button class="btn" onclick="markAsRead(this)">Mark as Read</button>
                                <button class="btn" onclick="viewSensorDetail('Sensor 2')">View Sensor</button>
                                <button class="btn danger" onclick="dismissAlert(this)">Dismiss</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Connectivity Alert -->
                    <div class="alert-item connectivity" data-priority="high" data-read="true">
                        <div class="alert-icon connectivity">
                            <i class="fas fa-wifi"></i>
                        </div>
                        <div class="alert-content">
                            <div class="alert-title">
                                <span class="alert-badge high">High</span>
                                Signal Strength Low
                            </div>
                            <div class="alert-message">Sensor 3 signal strength has dropped to 15% in Wheat Field B, Row 1.</div>
                            <div class="alert-time">45 minutes ago</div>
                            <div class="alert-actions">
                                <button class="btn" onclick="markAsRead(this)">Mark as Read</button>
                                <button class="btn" onclick="viewSensorDetail('Sensor 3')">View Sensor</button>
                                <button class="btn danger" onclick="dismissAlert(this)">Dismiss</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Humidity Alert -->
                    <div class="alert-item humidity" data-priority="medium" data-read="false">
                        <div class="alert-icon humidity">
                            <i class="fas fa-tint"></i>
                        </div>
                        <div class="alert-content">
                            <div class="alert-title">
                                <span class="alert-badge medium">Medium</span>
                                Low Humidity Alert
                            </div>
                            <div class="alert-message">Humidity below threshold (40%) in Wheat Field B, Row 2.</div>
                            <div class="alert-time">1 hour ago</div>
                            <div class="alert-actions">
                                <button class="btn" onclick="markAsRead(this)">Mark as Read</button>
                                <button class="btn" onclick="viewSensorDetail('Sensor 4')">View Sensor</button>
                                <button class="btn danger" onclick="dismissAlert(this)">Dismiss</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Crop Health Alert -->
                    <div class="alert-item crop" data-priority="high" data-read="false">
                        <div class="alert-icon crop">
                            <i class="fas fa-seedling"></i>
                        </div>
                        <div class="alert-content">
                            <div class="alert-title">
                                <span class="alert-badge high">High</span>
                                Crop Stress Detected
                            </div>
                            <div class="alert-message">Signs of water stress detected in Corn Field A. Immediate irrigation recommended.</div>
                            <div class="alert-time">2 hours ago</div>
                            <div class="alert-actions">
                                <button class="btn" onclick="markAsRead(this)">Mark as Read</button>
                                <button class="btn" onclick="scheduleIrrigation('Corn')">Schedule Irrigation</button>
                                <button class="btn danger" onclick="dismissAlert(this)">Dismiss</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Battery Alert 2 -->
                    <div class="alert-item battery" data-priority="low" data-read="true">
                        <div class="alert-icon battery">
                            <i class="fas fa-battery-half"></i>
                        </div>
                        <div class="alert-content">
                            <div class="alert-title">
                                <span class="alert-badge low">Low</span>
                                Battery Level Notice
                            </div>
                            <div class="alert-message">Sensor 4 battery level is at 40%, consider replacement in next maintenance.</div>
                            <div class="alert-time">3 hours ago</div>
                            <div class="alert-actions">
                                <button class="btn" onclick="markAsRead(this)">Mark as Read</button>
                                <button class="btn" onclick="viewSensorDetail('Sensor 4')">View Sensor</button>
                                <button class="btn danger" onclick="dismissAlert(this)">Dismiss</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Temperature Alert 2 -->
                    <div class="alert-item temperature" data-priority="medium" data-read="true">
                        <div class="alert-icon temperature">
                            <i class="fas fa-thermometer-half"></i>
                        </div>
                        <div class="alert-content">
                            <div class="alert-title">
                                <span class="alert-badge medium">Medium</span>
                                Temperature Fluctuation
                            </div>
                            <div class="alert-message">Unusual temperature fluctuation detected in Soybeans field. Monitoring recommended.</div>
                            <div class="alert-time">4 hours ago</div>
                            <div class="alert-actions">
                                <button class="btn" onclick="markAsRead(this)">Mark as Read</button>
                                <button class="btn" onclick="viewCropDetail('Soybeans')">View Crop</button>
                                <button class="btn danger" onclick="dismissAlert(this)">Dismiss</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Crop Health Alert 2 -->
                    <div class="alert-item crop" data-priority="low" data-read="true">
                        <div class="alert-icon crop">
                            <i class="fas fa-bug"></i>
                        </div>
                        <div class="alert-content">
                            <div class="alert-title">
                                <span class="alert-badge low">Low</span>
                                Potential Pest Activity
                            </div>
                            <div class="alert-message">Early signs of pest activity detected in Wheat Field B. Monitoring recommended.</div>
                            <div class="alert-time">Yesterday</div>
                            <div class="alert-actions">
                                <button class="btn" onclick="markAsRead(this)">Mark as Read</button>
                                <button class="btn" onclick="monitorPests('Wheat')">Monitor Pests</button>
                                <button class="btn danger" onclick="dismissAlert(this)">Dismiss</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Battery Alert 3 -->
                    <div class="alert-item battery" data-priority="high" data-read="true">
                        <div class="alert-icon battery">
                            <i class="fas fa-battery-empty"></i>
                        </div>
                        <div class="alert-content">
                            <div class="alert-title">
                                <span class="alert-badge high">High</span>
                                Critical Battery Level
                            </div>
                            <div class="alert-message">Sensor 5 battery level is at 5%, immediate replacement required.</div>
                            <div class="alert-time">2 days ago</div>
                            <div class="alert-actions">
                                <button class="btn" onclick="markAsRead(this)">Mark as Read</button>
                                <button class="btn" onclick="replaceBattery('Sensor 5')">Replace Battery</button>
                                <button class="btn danger" onclick="dismissAlert(this)">Dismiss</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Alert Trends Section -->
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-chart-line"></i>
                        Alert Trends
                    </h2>
                    <div class="action-buttons">
                        <span class="btn" onclick="changeTrendPeriod('day')" title="Daily View"><i class="fas fa-calendar-day"></i> Daily</span>
                        <span class="btn" onclick="changeTrendPeriod('week')" title="Weekly View"><i class="fas fa-calendar-week"></i> Weekly</span>
                        <span class="btn" onclick="changeTrendPeriod('month')" title="Monthly View"><i class="fas fa-calendar-alt"></i> Monthly</span>
                        <span class="btn" onclick="exportTrendData()" title="Export Trend Data"><i class="fas fa-download"></i> Export</span>
                    </div>
                </div>
                
                <div class="chart-container alert-chart">
                    <canvas id="alertTrendsChart"></canvas>
                </div>
                
                <div class="alert-dashboard">
                    <div class="alert-stat-card">
                        <div class="alert-category">Total Alerts</div>
                        <div class="alert-count">47</div>
                        <div style="font-size: 12px; color: #666;">This Month</div>
                    </div>
                    <div class="alert-stat-card">
                        <div class="alert-category">High Priority</div>
                        <div class="alert-count">12</div>
                        <div style="font-size: 12px; color: #666;">This Month</div>
                    </div>
                    <div class="alert-stat-card">
                        <div class="alert-category">Resolution Time</div>
                        <div class="alert-count">1.4h</div>
                        <div style="font-size: 12px; color: #666;">Average</div>
                    </div>
                    <div class="alert-stat-card">
                        <div class="alert-category">Recurring Issues</div>
                        <div class="alert-count">3</div>
                        <div style="font-size: 12px; color: #666;">Identified</div>
                    </div>
                </div>
            </div>
            
            <!-- Alert Timeline Section -->
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-history"></i>
                        Recent Alert Timeline
                    </h2>
                    <div class="action-buttons">
                        <span class="btn" onclick="viewFullTimeline()" title="View Full Timeline"><i class="fas fa-clock"></i> Full Timeline</span>
                        <span class="btn" onclick="exportTimelineData()" title="Export Timeline Data"><i class="fas fa-download"></i> Export</span>
                    </div>
                </div>
                
                <div class="alert-timeline">
                    <div class="timeline-line"></div>
                    
                    <div class="timeline-item">
                        <div class="timeline-dot" style="top: 25px; background: #f44336;"></div>
                        <div class="timeline-alert">
                            <div style="font-weight: 700; margin-bottom: 5px;">Today, 10:45 AM</div>
                            <div class="alert-item temperature" style="margin-bottom: 0;">
                                <div class="alert-icon temperature">
                                    <i class="fas fa-thermometer-full"></i>
                                </div>
                                <div class="alert-content">
                                    <div class="alert-title">
                                        <span class="alert-badge high">High</span>
                                        High Temperature Detected
                                    </div>
                                    <div class="alert-message">Sensor 1 temperature exceeds threshold (85째F) in Corn Field A, Row 1.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-dot" style="top: 25px; background: #ff9800;"></div>
                        <div class="timeline-alert">
                            <div style="font-weight: 700; margin-bottom: 5px;">Today, 10:30 AM</div>
                            <div class="alert-item battery" style="margin-bottom: 0;">
                                <div class="alert-icon battery">
                                    <i class="fas fa-battery-quarter"></i>
                                </div>
                                <div class="alert-content">
                                    <div class="alert-title">
                                        <span class="alert-badge medium">Medium</span>
                                        Low Battery Warning
                                    </div>
                                    <div class="alert-message">Sensor 2 battery level is at 20%, replacement needed soon.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-dot" style="top: 25px; background: #f44336;"></div>
                        <div class="timeline-alert">
                            <div style="font-weight: 700; margin-bottom: 5px;">Today, 10:00 AM</div>
                            <div class="alert-item connectivity" style="margin-bottom: 0;">
                                <div class="alert-icon connectivity">
                                    <i class="fas fa-wifi"></i>
                                </div>
                                <div class="alert-content">
                                    <div class="alert-title">
                                        <span class="alert-badge high">High</span>
                                        Signal Strength Low
                                    </div>
                                    <div class="alert-message">Sensor 3 signal strength has dropped to 15% in Wheat Field B, Row 1.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-dot" style="top: 25px; background: #ff9800;"></div>
                        <div class="timeline-alert">
                            <div style="font-weight: 700; margin-bottom: 5px;">Today, 9:45 AM</div>
                            <div class="alert-item humidity" style="margin-bottom: 0;">
                                <div class="alert-icon humidity">
                                    <i class="fas fa-tint"></i>
                                </div>
                                <div class="alert-content">
                                    <div class="alert-title">
                                        <span class="alert-badge medium">Medium</span>
                                        Low Humidity Alert
                                    </div>
                                    <div class="alert-message">Humidity below threshold (40%) in Wheat Field B, Row 2.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-dot" style="top: 25px; background: #f44336;"></div>
                        <div class="timeline-alert">
                            <div style="font-weight: 700; margin-bottom: 5px;">Today, 8:30 AM</div>
                            <div class="alert-item crop" style="margin-bottom: 0;">
                                <div class="alert-icon crop">
                                    <i class="fas fa-seedling"></i>
                                </div>
                                <div class="alert-content">
                                    <div class="alert-title">
                                        <span class="alert-badge high">High</span>
                                        Crop Stress Detected
                                    </div>
                                    <div class="alert-message">Signs of water stress detected in Corn Field A. Immediate irrigation recommended.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-dot" style="top: 25px; background: #2196f3;"></div>
                        <div class="timeline-alert">
                            <div style="font-weight: 700; margin-bottom: 5px;">Yesterday, 4:15 PM</div>
                            <div class="alert-item battery" style="margin-bottom: 0;">
                                <div class="alert-icon battery">
                                    <i class="fas fa-battery-half"></i>
                                </div>
                                <div class="alert-content">
                                    <div class="alert-title">
                                        <span class="alert-badge low">Low</span>
                                        Battery Level Notice
                                    </div>
                                    <div class="alert-message">Sensor 4 battery level is at 40%, consider replacement in next maintenance.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Alert Settings Section -->
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-sliders-h"></i>
                        Alert Settings
                    </h2>
                    <div class="action-buttons">
                        <span class="btn" onclick="saveAlertSettings()" title="Save Alert Settings"><i class="fas fa-save"></i> Save Settings</span>
                        <span class="btn" onclick="restoreDefaultSettings()" title="Restore Default Settings"><i class="fas fa-undo"></i> Restore Defaults</span>
                    </div>
                </div>
                
                <div class="alert-settings">
                    <div class="settings-row">
                        <div class="alert-type">
                            <i class="fas fa-thermometer-full" style="color: #f44336;"></i>
                            Temperature Alerts
                        </div>
                        <div class="alert-threshold">
                            <div>High: > <input type="number" class="threshold-control" value="85" id="tempHighThreshold">째F</div>
                            <div>Low: < <input type="number" class="threshold-control" value="45" id="tempLowThreshold">째F</div>
                            <label class="switch">
                                <input type="checkbox" checked id="tempAlertEnabled">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="settings-row">
                        <div class="alert-type">
                            <i class="fas fa-tint" style="color: #2196f3;"></i>
                            Humidity Alerts
                        </div>
                        <div class="alert-threshold">
                            <div>High: > <input type="number" class="threshold-control" value="90" id="humidHighThreshold">%</div>
                            <div>Low: < <input type="number" class="threshold-control" value="40" id="humidLowThreshold">%</div>
                            <label class="switch">
                                <input type="checkbox" checked id="humidAlertEnabled">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="settings-row">
                        <div class="alert-type">
                            <i class="fas fa-battery-half" style="color: #ffc107;"></i>
                            Battery Alerts
                        </div>
                        <div class="alert-threshold">
                            <div>Low: < <input type="number" class="threshold-control" value="20" id="batteryLowThreshold">%</div>
                            <div>Critical: < <input type="number" class="threshold-control" value="10" id="batteryCriticalThreshold">%</div>
                            <label class="switch">
                                <input type="checkbox" checked id="batteryAlertEnabled">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="settings-row">
                        <div class="alert-type">
                            <i class="fas fa-wifi" style="color: #ff5722;"></i>
                            Signal Strength Alerts
                        </div>
                        <div class="alert-threshold">
                            <div>Low: < <input type="number" class="threshold-control" value="30" id="signalLowThreshold">%</div>
                            <div>Critical: < <input type="number" class="threshold-control" value="15" id="signalCriticalThreshold">%</div>
                            <label class="switch">
                                <input type="checkbox" checked id="signalAlertEnabled">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="settings-row">
                        <div class="alert-type">
                            <i class="fas fa-seedling" style="color: #4caf50;"></i>
                            Crop Health Alerts
                        </div>
                        <div class="alert-threshold">
                            <div>Moisture: < <input type="number" class="threshold-control" value="50" id="moistureThreshold">%</div>
                            <div>Stress Index: > <input type="number" class="threshold-control" value="70" id="stressThreshold">%</div>
                            <label class="switch">
                                <input type="checkbox" checked id="cropAlertEnabled">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="settings-row">
                        <div class="alert-type">
                            <i class="fas fa-cog" style="color: #9c27b0;"></i>
                            System Alerts
                        </div>
                        <div class="alert-threshold">
                            <div>
                                <label class="switch">
                                    <input type="checkbox" checked id="systemAlertEnabled">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="settings-row">
                        <div class="alert-type">
                            <i class="fas fa-bell" style="color: #607d8b;"></i>
                            Notification Method
                        </div>
                        <div class="alert-threshold">
                            <select class="threshold-control" style="width: auto;" id="notificationMethod">
                                <option value="app">In-App Only</option>
                                <option value="email">Email</option>
                                <option value="sms">SMS</option>
                                <option value="all" selected>All Methods</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="settings-row">
                        <div class="alert-type">
                            <i class="fas fa-clock" style="color: #607d8b;"></i>
                            Alert Check Frequency
                        </div>
                        <div class="alert-threshold">
                            <select class="threshold-control" style="width: auto;" id="alertFrequency">
                                <option value="1">Every 1 minute</option>
                                <option value="5" selected>Every 5 minutes</option>
                                <option value="15">Every 15 minutes</option>
                                <option value="30">Every 30 minutes</option>
                                <option value="60">Every hour</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="nav-bar">
            <a href="index.html" class="nav-item" title="Farm Dashboard">
                <i class="fas fa-home"></i>
                <span>Home</span>
            </a>
            <a href="sensors.html" class="nav-item" title="Sensor Management">
                <i class="fas fa-microchip"></i>
                <span>Sensors</span>
            </a>
            <a href="weather.html" class="nav-item" title="Weather Command Station">
                <i class="fas fa-cloud-sun"></i>
                <span>Weather</span>
            </a>
            <a href="analytics.html" class="nav-item" title="Data Analytics">
                <i class="fas fa-chart-line"></i>
                <span>Analytics</span>
            </a>
            <a href="alerts.html" class="nav-item active" title="Alert Command Center">
                <i class="fas fa-bell"></i>
                <span>Alerts</span>
            </a>
            <a href="settings.html" class="nav-item" title="System Settings">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </a>
        </div>
    </div>

    <script src="chart.js"></script>
    <script>
        // Fix navigation bar positioning
        document.addEventListener('DOMContentLoaded', function() {
            fixNavBarStyling();
            
            // Initialize charts
            createAlertsOverviewChart();
            createAlertTrendsChart();
            
            // Update alert counts
            updateAlertCounts();
        });
        
        // Sample alerts data (in a real app, this would come from the backend)
        const alertsData = {
            temperature: {
                count: 2,
                history: [3, 2, 4, 1, 2, 3, 2]
            },
            humidity: {
                count: 1,
                history: [1, 2, 0, 1, 1, 0, 1]
            },
            battery: {
                count: 3,
                history: [2, 1, 3, 4, 2, 3, 3]
            },
            system: {
                count: 0,
                history: [0, 1, 0, 0, 0, 1, 0]
            },
            connectivity: {
                count: 1,
                history: [0, 0, 1, 2, 1, 0, 1]
            },
            crop: {
                count: 2,
                history: [1, 3, 2, 1, 0, 1, 2]
            }
        };
        
        // Update alert counts from data
        function updateAlertCounts() {
            for (const [type, data] of Object.entries(alertsData)) {
                const countElement = document.getElementById(`${type}AlertCount`);
                const progressElement = document.getElementById(`${type}Progress`);
                
                if (countElement) {
                    countElement.textContent = data.count;
                }
                
                if (progressElement) {
                    progressElement.style.width = `${data.count * 10}%`;
                }
            }
        }
        
        // Create the alerts overview chart
        function createAlertsOverviewChart() {
            const ctx = document.getElementById('alertsOverviewChart').getContext('2d');
            
            const chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Temperature', 'Humidity', 'Battery', 'System', 'Connectivity', 'Crop Health'],
                    datasets: [{
                        label: 'Active Alerts',
                        data: [
                            alertsData.temperature.count,
                            alertsData.humidity.count,
                            alertsData.battery.count,
                            alertsData.system.count,
                            alertsData.connectivity.count,
                            alertsData.crop.count
                        ],
                        backgroundColor: [
                            'rgba(244, 67, 54, 0.7)',
                            'rgba(33, 150, 243, 0.7)',
                            'rgba(255, 193, 7, 0.7)',
                            'rgba(156, 39, 176, 0.7)',
                            'rgba(255, 87, 34, 0.7)',
                            'rgba(76, 175, 80, 0.7)'
                        ],
                        borderColor: [
                            'rgba(244, 67, 54, 1)',
                            'rgba(33, 150, 243, 1)',
                            'rgba(255, 193, 7, 1)',
                            'rgba(156, 39, 176, 1)',
                            'rgba(255, 87, 34, 1)',
                            'rgba(76, 175, 80, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${context.raw}`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Create the alert trends chart
        function createAlertTrendsChart() {
            const ctx = document.getElementById('alertTrendsChart').getContext('2d');
            
            const labels = ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Today'];
            
            const chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Temperature',
                            data: alertsData.temperature.history,
                            borderColor: 'rgba(244, 67, 54, 1)',
                            backgroundColor: 'rgba(244, 67, 54, 0.1)',
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Humidity',
                            data: alertsData.humidity.history,
                            borderColor: 'rgba(33, 150, 243, 1)',
                            backgroundColor: 'rgba(33, 150, 243, 0.1)',
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Battery',
                            data: alertsData.battery.history,
                            borderColor: 'rgba(255, 193, 7, 1)',
                            backgroundColor: 'rgba(255, 193, 7, 0.1)',
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Crop Health',
                            data: alertsData.crop.history,
                            borderColor: 'rgba(76, 175, 80, 1)',
                            backgroundColor: 'rgba(76, 175, 80, 0.1)',
                            fill: true,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        },
                        legend: {
                            position: 'top',
                            labels: {
                                boxWidth: 12,
                                usePointStyle: true
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }
        
        // Filter alerts by category or priority
        function filterAlerts(filter) {
            const alertItems = document.querySelectorAll('.alert-item');
            const filterButtons = document.querySelectorAll('.filter-button');
            
            // Update active filter button
            filterButtons.forEach(button => {
                if (button.textContent.toLowerCase().includes(filter)) {
                    button.classList.add('active');
                } else {
                    button.classList.remove('active');
                }
            });
            
            // Apply filter
            alertItems.forEach(item => {
                const priority = item.getAttribute('data-priority');
                const isRead = item.getAttribute('data-read') === 'true';
                const alertType = Array.from(item.classList)
                    .find(cls => ['temperature', 'humidity', 'battery', 'system', 'connectivity', 'crop'].includes(cls));
                
                if (filter === 'all') {
                    item.style.display = 'flex';
                } else if (filter === 'high' || filter === 'medium' || filter === 'low') {
                    item.style.display = priority === filter ? 'flex' : 'none';
                } else if (filter === 'unread') {
                    item.style.display = !isRead ? 'flex' : 'none';
                } else if (['temperature', 'humidity', 'battery', 'system', 'connectivity', 'crop'].includes(filter)) {
                    item.style.display = alertType === filter ? 'flex' : 'none';
                }
            });
        }
        
        // Sort alerts by time or priority
        function sortAlerts(sortBy) {
            const alertList = document.getElementById('alertList');
            const alerts = Array.from(alertList.querySelectorAll('.alert-item'));
            
            alerts.sort((a, b) => {
                if (sortBy === 'time') {
                    const timeA = a.querySelector('.alert-time').textContent;
                    const timeB = b.querySelector('.alert-time').textContent;
                    
                    // Sort newest first (this is a simple string comparison, 
                    // in a real app you'd use proper datetime objects)
                    return timeA.localeCompare(timeB);
                } else if (sortBy === 'priority') {
                    const priorityMap = { high: 0, medium: 1, low: 2 };
                    const priorityA = priorityMap[a.getAttribute('data-priority')];
                    const priorityB = priorityMap[b.getAttribute('data-priority')];
                    
                    // Sort highest priority first
                    return priorityA - priorityB;
                }
                return 0;
            });
            
            // Clear and re-append sorted items
            alerts.forEach(alert => alertList.removeChild(alert));
            alerts.forEach(alert => alertList.appendChild(alert));
        }
        
        // Mark an alert as read
        function markAsRead(button) {
            const alertItem = button.closest('.alert-item');
            const isRead = alertItem.getAttribute('data-read') === 'true';
            
            alertItem.setAttribute('data-read', !isRead);
            button.textContent = isRead ? 'Mark as Read' : 'Mark as Unread';
            
            // Update total unread count (in a real app, you'd update a backend)
            updateUnreadCount();
        }
        
        // Mark all alerts as read
        function markAllAsRead() {
            document.querySelectorAll('.alert-item').forEach(item => {
                item.setAttribute('data-read', 'true');
                const button = item.querySelector('.alert-actions button:first-child');
                if (button) {
                    button.textContent = 'Mark as Unread';
                }
            });
            
            // Update total unread count
            updateUnreadCount();
            showToast('All alerts marked as read');
        }
        
        // Update the unread count
        function updateUnreadCount() {
            const unreadItems = document.querySelectorAll('.alert-item[data-read="false"]');
            const count = unreadItems.length;
            
            // In a real app, you might update a badge or notify the backend
            console.log(`Unread alerts: ${count}`);
        }
        
        // Dismiss an alert
        function dismissAlert(button) {
            const alertItem = button.closest('.alert-item');
            
            // Animate the removal
            alertItem.style.opacity = '0';
            alertItem.style.transform = 'translateX(20px)';
            
            setTimeout(() => {
                alertItem.remove();
                // Update alert counts
                updateAlertCounts();
            }, 300);
            
            showToast('Alert dismissed');
        }
        
        // Clear all alerts
        function clearAllAlerts() {
            if (confirm('Are you sure you want to dismiss all alerts?')) {
                const alertItems = document.querySelectorAll('.alert-item');
                
                // Animate removal of all alerts
                alertItems.forEach((item, index) => {
                    setTimeout(() => {
                        item.style.opacity = '0';
                        item.style.transform = 'translateX(20px)';
                        
                        setTimeout(() => {
                            item.remove();
                            // Update counts when last alert is removed
                            if (index === alertItems.length - 1) {
                                // Reset alert counts in data
                                Object.keys(alertsData).forEach(key => {
                                    alertsData[key].count = 0;
                                });
                                updateAlertCounts();
                                // Update charts
                                createAlertsOverviewChart();
                            }
                        }, 300);
                    }, index * 50);
                });
                
                showToast('All alerts cleared');
            }
        }
        
        // Archive resolved alerts
        function archiveAlerts() {
            const readAlerts = document.querySelectorAll('.alert-item[data-read="true"]');
            
            if (readAlerts.length === 0) {
                showToast('No read alerts to archive');
                return;
            }
            
            readAlerts.forEach((item, index) => {
                setTimeout(() => {
                    item.style.opacity = '0';
                    item.style.transform = 'translateX(20px)';
                    
                    setTimeout(() => {
                        item.remove();
                        // Update counts when last alert is removed
                        if (index === readAlerts.length - 1) {
                            updateAlertCounts();
                            // Update charts
                            createAlertsOverviewChart();
                        }
                    }, 300);
                }, index * 50);
            });
            
            showToast(`${readAlerts.length} alerts archived`);
        }
        
        // Refresh alerts data
        function refreshAlerts() {
            showToast('Refreshing alert data...');
            
            // Simulate refresh with a timeout
            setTimeout(() => {
                // In a real app, you'd fetch fresh data from the backend
                createAlertsOverviewChart();
                createAlertTrendsChart();
                updateAlertCounts();
                
                showToast('Alert data refreshed');
            }, 1000);
        }
        
        // Test the alert system
        function testAlert() {
            // Create a test alert element
            const alertList = document.getElementById('alertList');
            const testAlert = document.createElement('div');
            testAlert.className = 'alert-item system';
            testAlert.setAttribute('data-priority', 'medium');
            testAlert.setAttribute('data-read', 'false');
            
            testAlert.innerHTML = `
                <div class="alert-icon system">
                    <i class="fas fa-bell"></i>
                </div>
                <div class="alert-content">
                    <div class="alert-title">
                        <span class="alert-badge medium">Medium</span>
                        Test Alert
                    </div>
                    <div class="alert-message">This is a test alert to verify the notification system is working properly.</div>
                    <div class="alert-time">Just now</div>
                    <div class="alert-actions">
                        <button class="btn" onclick="markAsRead(this)">Mark as Read</button>
                        <button class="btn danger" onclick="dismissAlert(this)">Dismiss</button>
                    </div>
                </div>
            `;
            
            // Insert at the top of the list
            if (alertList.firstChild) {
                alertList.insertBefore(testAlert, alertList.firstChild);
            } else {
                alertList.appendChild(testAlert);
            }
            
            // Update system alert count
            alertsData.system.count++;
            document.getElementById('systemAlertCount').textContent = alertsData.system.count;
            document.getElementById('systemProgress').style.width = `${alertsData.system.count * 10}%`;
            
            // Update charts
            createAlertsOverviewChart();
            
            showToast('Test alert created');
        }
        
        // Export alert data as JSON
        function exportAlertData() {
            // In a real app, you'd collect all alert data from the backend
            // For this demo, we'll use the alertsData object
            const exportData = {
                alerts: alertsData,
                timestamp: new Date().toISOString(),
                exportType: 'alert_data'
            };
            
            // Convert to JSON and create download link
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(exportData, null, 2));
            const downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute("href", dataStr);
            downloadAnchorNode.setAttribute("download", "alert_data.json");
            document.body.appendChild(downloadAnchorNode);
            downloadAnchorNode.click();
            downloadAnchorNode.remove();
            
            showToast('Alert data exported');
        }
        
        // Export trend data
        function exportTrendData() {
            // Similar to exportAlertData, but specifically for trend data
            const trendData = {
                trends: alertsData,
                period: 'weekly',
                timestamp: new Date().toISOString(),
                exportType: 'trend_data'
            };
            
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(trendData, null, 2));
            const downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute("href", dataStr);
            downloadAnchorNode.setAttribute("download", "alert_trends.json");
            document.body.appendChild(downloadAnchorNode);
            downloadAnchorNode.click();
            downloadAnchorNode.remove();
            
            showToast('Trend data exported');
        }
        
        // Export timeline data
        function exportTimelineData() {
            // In a real app, you'd collect timeline data from the backend
            const timelineData = {
                timeline: [
                    {
                        time: '2025-03-07T10:45:00Z',
                        type: 'temperature',
                        priority: 'high',
                        message: 'Sensor 1 temperature exceeds threshold (85째F) in Corn Field A, Row 1.'
                    },
                    {
                        time: '2025-03-07T10:30:00Z',
                        type: 'battery',
                        priority: 'medium',
                        message: 'Sensor 2 battery level is at 20%, replacement needed soon.'
                    },
                    // Add more timeline entries...
                ],
                timestamp: new Date().toISOString(),
                exportType: 'timeline_data'
            };
            
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(timelineData, null, 2));
            const downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute("href", dataStr);
            downloadAnchorNode.setAttribute("download", "alert_timeline.json");
            document.body.appendChild(downloadAnchorNode);
            downloadAnchorNode.click();
            downloadAnchorNode.remove();
            
            showToast('Timeline data exported');
        }
        
        // Change the trend period for the chart
        function changeTrendPeriod(period) {
            // In a real app, you'd fetch different data based on the period
            const ctx = document.getElementById('alertTrendsChart').getContext('2d');
            
            let labels;
            switch(period) {
                case 'day':
                    labels = ['6:00', '9:00', '12:00', '15:00', '18:00', '21:00', 'Now'];
                    break;
                case 'week':
                    labels = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
                    break;
                case 'month':
                    labels = ['Week 1', 'Week 2', 'Week 3', 'Week 4'];
                    break;
                default:
                    labels = ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Today'];
            }
            
            // Clear existing chart
            if (window.trendChart) {
                window.trendChart.destroy();
            }
            
            // Create new chart with period-specific data
            window.trendChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Temperature',
                            data: period === 'month' ? [10, 8, 12, 9] : alertsData.temperature.history,
                            borderColor: 'rgba(244, 67, 54, 1)',
                            backgroundColor: 'rgba(244, 67, 54, 0.1)',
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Humidity',
                            data: period === 'month' ? [5, 7, 3, 6] : alertsData.humidity.history,
                            borderColor: 'rgba(33, 150, 243, 1)',
                            backgroundColor: 'rgba(33, 150, 243, 0.1)',
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Battery',
                            data: period === 'month' ? [12, 15, 10, 8] : alertsData.battery.history,
                            borderColor: 'rgba(255, 193, 7, 1)',
                            backgroundColor: 'rgba(255, 193, 7, 0.1)',
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Crop Health',
                            data: period === 'month' ? [8, 6, 9, 7] : alertsData.crop.history,
                            borderColor: 'rgba(76, 175, 80, 1)',
                            backgroundColor: 'rgba(76, 175, 80, 0.1)',
                            fill: true,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        },
                        legend: {
                            position: 'top',
                            labels: {
                                boxWidth: 12,
                                usePointStyle: true
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: period === 'month' ? 5 : 1
                            }
                        }
                    }
                }
            });
            
            showToast(`Showing ${period}ly alert trends`);
        }
        
        // View the full alert timeline
        function viewFullTimeline() {
            alert('In a full application, this would display a complete timeline of all alerts with advanced filtering options.');
        }
        
        // Save alert settings
        function saveAlertSettings() {
            // In a real app, you'd send these settings to the backend
            const settings = {
                temperature: {
                    highThreshold: document.getElementById('tempHighThreshold').value,
                    lowThreshold: document.getElementById('tempLowThreshold').value,
                    enabled: document.getElementById('tempAlertEnabled').checked
                },
                humidity: {
                    highThreshold: document.getElementById('humidHighThreshold').value,
                    lowThreshold: document.getElementById('humidLowThreshold').value,
                    enabled: document.getElementById('humidAlertEnabled').checked
                },
                battery: {
                    lowThreshold: document.getElementById('batteryLowThreshold').value,
                    criticalThreshold: document.getElementById('batteryCriticalThreshold').value,
                    enabled: document.getElementById('batteryAlertEnabled').checked
                },
                signal: {
                    lowThreshold: document.getElementById('signalLowThreshold').value,
                    criticalThreshold: document.getElementById('signalCriticalThreshold').value,
                    enabled: document.getElementById('signalAlertEnabled').checked
                },
                crop: {
                    moistureThreshold: document.getElementById('moistureThreshold').value,
                    stressThreshold: document.getElementById('stressThreshold').value,
                    enabled: document.getElementById('cropAlertEnabled').checked
                },
                system: {
                    enabled: document.getElementById('systemAlertEnabled').checked
                },
                notification: {
                    method: document.getElementById('notificationMethod').value,
                    frequency: document.getElementById('alertFrequency').value
                }
            };
            
            console.log('Alert settings saved:', settings);
            showToast('Alert settings saved successfully');
        }
        
        // Restore default alert settings
        function restoreDefaultSettings() {
            if (confirm('Reset all alert settings to default values?')) {
                // Reset temperature settings
                document.getElementById('tempHighThreshold').value = '85';
                document.getElementById('tempLowThreshold').value = '45';
                document.getElementById('tempAlertEnabled').checked = true;
                
                // Reset humidity settings
                document.getElementById('humidHighThreshold').value = '90';
                document.getElementById('humidLowThreshold').value = '40';
                document.getElementById('humidAlertEnabled').checked = true;
                
                // Reset battery settings
                document.getElementById('batteryLowThreshold').value = '20';
                document.getElementById('batteryCriticalThreshold').value = '10';
                document.getElementById('batteryAlertEnabled').checked = true;
                
                // Reset signal settings
                document.getElementById('signalLowThreshold').value = '30';
                document.getElementById('signalCriticalThreshold').value = '15';
                document.getElementById('signalAlertEnabled').checked = true;
                
                // Reset crop settings
                document.getElementById('moistureThreshold').value = '50';
                document.getElementById('stressThreshold').value = '70';
                document.getElementById('cropAlertEnabled').checked = true;
                
                // Reset system settings
                document.getElementById('systemAlertEnabled').checked = true;
                
                // Reset notification settings
                document.getElementById('notificationMethod').value = 'all';
                document.getElementById('alertFrequency').value = '5';
                
                showToast('Alert settings restored to defaults');
            }
        }
        
        // Configure alert settings modal
        function configureAlertSettings() {
            // Scroll to the alert settings section
            document.querySelector('.alert-settings').scrollIntoView({ behavior: 'smooth' });
        }
        
        // Set alert rules
        function setAlertRules() {
            // Scroll to the alert settings section
            document.querySelector('.alert-settings').scrollIntoView({ behavior: 'smooth' });
        }
        
        // View sensor detail
        function viewSensorDetail(sensorId) {
            // In a real app, you'd navigate to the sensor detail page
            window.location.href = `sensors.html?sensor=${sensorId}`;
        }
        
        // View crop detail
        function viewCropDetail(cropType) {
            // In a real app, you'd navigate to the crop detail page
            window.location.href = `analytics.html?crop=${cropType}`;
        }
        
        // Schedule irrigation
        function scheduleIrrigation(cropType) {
            showToast(`Irrigation scheduled for ${cropType} fields`);
        }
        
        // Monitor pests
        function monitorPests(cropType) {
            showToast(`Pest monitoring initiated for ${cropType} fields`);
        }
        
        // Replace battery
        function replaceBattery(sensorId) {
            showToast(`Battery replacement scheduled for ${sensorId}`);
        }
        
        // Toast notification helper
        function showToast(message) {
            // Create and append toast element
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.textContent = message;
            
            // Style the toast
            Object.assign(toast.style, {
                position: 'fixed',
                bottom: '100px',
                left: '50%',
                transform: 'translateX(-50%)',
                backgroundColor: 'rgba(76, 175, 80, 0.9)',
                color: 'white',
                padding: '10px 20px',
                borderRadius: '4px',
                boxShadow: '0 2px 10px rgba(0,0,0,0.2)',
                zIndex: '10000',
                transition: 'opacity 0.3s, transform 0.3s',
                opacity: '0',
                fontWeight: '500'
            });
            
            document.body.appendChild(toast);
            
            // Animate in
            setTimeout(() => {
                toast.style.opacity = '1';
                toast.style.transform = 'translateX(-50%) translateY(0)';
            }, 10);
            
            // Animate out and remove
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(-50%) translateY(20px)';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }
    </script>
</body>
</html>
